<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>A walkthrough of the segregation package</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">A walkthrough of the segregation package</h1>



<p>The <code>segregation</code> package includes functionality to calculate entropy-based segregation measures, namely the Mutual Information Index (M) and the Theil Index (H), which is a normalized version of the M index. The package also includes several methods for decomposing the index into between/within components and into local segregation scores, as well as methods to decompose differences in segregation indices. All of these methods have arguments to obtain standard errors and confidence intervals through bootstrapping.</p>
<p>Detailed information on these indices can be found in the references at the end of this vignette.</p>
<div id="the-basic-mathematics" class="section level2">
<h2>The basic mathematics</h2>
<p>The idea of a segregation index is to summarize a contingency table to a single number. For instance, we may have a table with <span class="math inline">\(U\)</span> units, say schools or occupations, and <span class="math inline">\(G\)</span> groups, say gender or racial groups. For each combination of unit and group we have a count, <span class="math inline">\(t_{ug}\)</span>. Arranged in a <span class="math inline">\(U\times G\)</span> matrix <span class="math inline">\(\mathbf{T}\)</span>, this is what the structure of the data looks like:</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(g=1\)</span></th>
<th align="center">…</th>
<th align="center"><span class="math inline">\(g=G\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(u=1\)</span></td>
<td align="center"><span class="math inline">\(t_{11}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{1G}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(u=2\)</span></td>
<td align="center"><span class="math inline">\(t_{21}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{2G}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(u=3\)</span></td>
<td align="center"><span class="math inline">\(t_{31}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{3G}\)</span></td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(u=U\)</span></td>
<td align="center"><span class="math inline">\(t_{U1}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{UG}\)</span></td>
</tr>
</tbody>
</table>
<p>From this matrix, we can define <span class="math inline">\(t=\sum_{u=1}^U\sum_{g=1}^G t_{ug}\)</span>, the total population size. The joint probability of being in unit <span class="math inline">\(u\)</span> and racial group <span class="math inline">\(g\)</span> is <span class="math inline">\(p_{ug}=t_{ug}/t\)</span>. Also define <span class="math inline">\(p_{u \cdot}=\sum_{g=1}^{G}t_{ug}/t\)</span> and <span class="math inline">\(p_{\cdot g}=\sum_{u=1}^{U}t_{ug}/t\)</span> as the marginal probabilities of units and groups, respectively. The <strong>Mutual Information Index</strong> is then defined as</p>
<p><span class="math display">\[
M(\mathbf{T})=\sum_{u=1}^U\sum_{g=1}^Gp_{ug}\log\frac{p_{ug}}{p_{u \cdot}p_{\cdot g}}.
\]</span> The <strong>Theil Index</strong> is closely related to the M index, as it is just a normalized version of the Mutual Information Index:</p>
<p><span class="math display">\[
H(\mathbf{T})=\frac{M(\mathbf{T})}{E(\mathbf{T})},
\]</span></p>
<p>where <span class="math inline">\(E(\mathbf{T})\)</span> denotes the entropy of the group marginal distribution of <span class="math inline">\(\mathbf{T}\)</span>, i.e. <span class="math inline">\(E(\mathbf{T})=-\sum_{g=1}^{G}p_{\cdot g}\log p_{\cdot g}\)</span>. Dividing through the group entropy has the effect of constraining H to be between 0 and 1.</p>
</div>
<div id="data-format" class="section level2">
<h2>Data format</h2>
<p>For the examples, we will use a dataset built into the <code>segregation</code> package, <code>schools00</code>. This dataset contains data on 2,045 schools across 429 school districts in three U.S. states. For each school, the dataset records the number of Asian, Black, Hispanic, White, and Native American students. The <code>segregation</code> package requires data in long form (because most segregation data comes in this form), not in the form of contingency tables. Hence, each row of the <code>schools00</code> dataset is a unique combination of a given school and a racial group, and the column <code>n</code> records the number of students for this combination:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;segregation&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(schools00[, <span class="fu">c</span>(<span class="st">&quot;school&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;n&quot;</span>)])</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    school   race     n</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fctr&gt; &lt;fctr&gt; &lt;num&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:   A1_1  asian     2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:   A1_1  black    14</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:   A1_1   hisp    30</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:   A1_1  white   351</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:   A1_2  black     9</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:   A1_2   hisp   101</span></span></code></pre></div>
<p>Note that in the first school, <code>A1_1</code>, there are no Native American students. Hence, that row is missing.</p>
<p>If you have data in the form of contingency tables, you can use <code>matrix_to_long()</code> to convert them to the long format required for the package. As an example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">20</span>, <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   10   30</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   20   20</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]   30   10</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Black&quot;</span>, <span class="st">&quot;White&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix_to_long</span>(m, <span class="at">group =</span> <span class="st">&quot;race&quot;</span>, <span class="at">unit =</span> <span class="st">&quot;school&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    school   race     n</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt; &lt;char&gt; &lt;num&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      1  Black    10</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      2  Black    20</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:      3  Black    30</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:      1  White    30</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:      2  White    20</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:      3  White    10</span></span></code></pre></div>
<p>The <code>group</code> and <code>unit</code> arguments are optional.</p>
</div>
<div id="computing-the-m-and-h-indices" class="section level2">
<h2>Computing the M and H indices</h2>
<p>Compute the M and H indices using <code>mutual_total()</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.4255390</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.4188083</span></span></code></pre></div>
<p>Interpreting the M is not easy, because it is not normalized. However, the H can range from 0 to 1, so a value of 0.419 would indicate moderate segregation.</p>
<p>The second argument to <code>mutual_total()</code> refers to the groups, while the third argument refers to the units. Switching groups and units does not affect the M index, but does change the H index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(schools00, <span class="st">&quot;school&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat        est</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;      &lt;num&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.42553898</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.05642991</span></span></code></pre></div>
<p>This is because the <code>segregation</code> package always divides by the marginal <em>group</em> entropy, and it would here hence divide by the entropy of the school distribution, which we would expect to be much larger (as there are many more schools than racial groups). To check, we can use the <code>entropy()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">entropy</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.016071</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">entropy</span>(schools00, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 7.541018</span></span></code></pre></div>
<p>Therefore, if the H index is used, it is important to specify the groups and units correctly.</p>
<p>For inference (discussed in more detail <a href="#inference">below</a>), we can use bootstrapping to obtain standard errors and confidence intervals:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">CI =</span> .<span class="dv">95</span>, <span class="at">n_bootstrap =</span> <span class="dv">500</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 bootstrap iterations on 877739 observations</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est           se                  CI        bias</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;        &lt;num&gt;              &lt;list&gt;       &lt;num&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.4219016 0.0007391065 0.4204488,0.4233299 0.003637402</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.4152246 0.0006731706 0.4138427,0.4164415 0.003583707</span></span></code></pre></div>
<p>As there a large number of observations, the standard errors are very small.</p>
</div>
<div id="between-within-decomposition" class="section level2">
<h2>Between-Within decomposition</h2>
<p>We might wonder whether segregation is different across the three different states. We can compute their segregation indices manually (just showing the M for simplicity):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>split_schools <span class="ot">&lt;-</span> <span class="fu">split</span>(schools00, schools00<span class="sc">$</span>state)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(split_schools<span class="sc">$</span>A, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)[<span class="dv">1</span>, ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.4085965</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(split_schools<span class="sc">$</span>B, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)[<span class="dv">1</span>, ]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.2549959</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total</span>(split_schools<span class="sc">$</span>C, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)[<span class="dv">1</span>, ]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.3450221</span></span></code></pre></div>
<p>Clearly, state A is more segregated than state C, which in turn shows higher school segregation than B. One of the advantages of entropy-based segregation indices is that these three state-specific indices have a simple relationship to the overall index. This is called the between/within decomposition: Total segregation can be decomposed into a term that measures how much the distribution of racial groups differs <em>between</em> states, and into a term that measures segregation <em>within</em> states. If we have <span class="math inline">\(S\)</span> states (or “super-units” more generally), where each school belongs to exactly one state, the M index can be decomposed as follows:</p>
<p><span class="math display">\[
M(\mathbf{T})=M(\mathbf{S}) + \sum_{s=1}^S p_s M(\mathbf{T}_s),
\]</span> where <span class="math inline">\(\mathbf{T}\)</span> is the full <span class="math inline">\(U \times G\)</span> contingency table, <span class="math inline">\(\mathbf{S}\)</span> is the aggregated contingency table of dimension <span class="math inline">\(S\times G\)</span>, <span class="math inline">\(p_s\)</span> is the population proportion of state <span class="math inline">\(s\)</span> (such that <span class="math inline">\(\sum_{s=1}^S p_s=1\)</span>), and <span class="math inline">\(\mathbf{T}_s\)</span> is the subset of rows of <span class="math inline">\(\mathbf{T}\)</span> belonging to state <span class="math inline">\(s\)</span>. Put in simple terms, the M index can be decomposed into a between-state segregation index, plus a weighted average of within-state M indices.</p>
<p>For the H index, we are dividing the above formula by <span class="math inline">\(E(\mathbf{T})\)</span>. This makes the formula a bit more complicated, because the normalization has to be offset in the decomposition:</p>
<p><span class="math display">\[
H(\mathbf{T})=H(\mathbf{S}) + \sum_{s=1}^S \frac{E(\mathbf{T}_s)}{E(\mathbf{T})} p_s H(\mathbf{T}_s),
\]</span></p>
<p>where <span class="math inline">\(E(\cdot)\)</span> is again the entropy of the marginal group distribution. Note that <span class="math inline">\(E(\mathbf{T})=E(\mathbf{S})\)</span>, because the group marginal distributions are identical.</p>
<p>To compute the decomposition using the <code>segregation</code> package, use:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total segregation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>(total <span class="ot">&lt;-</span> <span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.4255390</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.4188083</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># between-state segregation:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     how much does the racial distributions differ across states?</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>(between <span class="ot">&lt;-</span> <span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat        est</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;      &lt;num&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.09924370</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.09767398</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># within-state segregation:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     how much segregation exist within states?</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">within =</span> <span class="st">&quot;state&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.3262953</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.3211343</span></span></code></pre></div>
<p>Note that <span class="math inline">\(0.426 = 0.0992 + 0.326\)</span> and <span class="math inline">\(0.419 = 0.0977 + 0.321\)</span>. The results indicate that about 75% of the segregation is within states. In other words, differences in the racial composition of the three different states account for less than 25% of segregation.</p>
<p>By using <code>mutual_total()</code> with the <code>within</code> argument, we can obtain the overall within component, but we do not obtain the decomposition by state. To do so, we can use <code>mutual_within()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(within <span class="ot">&lt;-</span> <span class="fu">mutual_within</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> <span class="st">&quot;state&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>, <span class="at">wide =</span> <span class="cn">TRUE</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Key: &lt;state&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     state         M         p         H ent_ratio</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fctr&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      A 0.4085965 0.2768819 0.4969216 0.8092501</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      B 0.2549959 0.4035425 0.2680884 0.9361190</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:      C 0.3450221 0.3195756 0.3611257 0.9402955</span></span></code></pre></div>
<p>This is a much simpler way to obtain state-specific segregation scores compared to subsetting manually, as shown in the beginning of this section. In addition to the M and H indices, we also obtain <code>p</code>, the population proportion of the state (<span class="math inline">\(p_s\)</span> above), and <code>ent_ratio</code>, which is <span class="math inline">\(E(\mathbf{T}_s)/E(\mathbf{T})\)</span> from above. Hence, we can recover the total within-component using</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(within, <span class="fu">sum</span>(M <span class="sc">*</span> p))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3262953</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(within, <span class="fu">sum</span>(H <span class="sc">*</span> p <span class="sc">*</span> ent_ratio))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3211343</span></span></code></pre></div>
<p>which is exactly the same as before. The quantity <span class="math inline">\(p_s M(\mathbf{T}_s)\)</span> is itself of interest, because it shows how much the states contribute to the segregation total, when taking into account their size. By adding the between component, we can calculate the contribution of the four components:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge into a vector</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>components <span class="ot">&lt;-</span> <span class="fu">c</span>(between<span class="sc">$</span>est[<span class="dv">1</span>], within<span class="sc">$</span>M <span class="sc">*</span> within<span class="sc">$</span>p)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(components) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Between&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(<span class="dv">100</span> <span class="sc">*</span> components <span class="sc">/</span> total<span class="sc">$</span>est[<span class="dv">1</span>], <span class="dv">3</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Between       A       B       C </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    23.3    26.6    24.2    25.9</span></span></code></pre></div>
<p>Each of the four components contributes about a quarter to the total segregation of 0.426. Note that state A is the smallest state (27.7% of the population), but contributes the largest percentage (26.6%) to total segregation. Hence, the decomposition shows that it is important to look at both <span class="math inline">\(p_s\)</span>, the state sizes, as well as <span class="math inline">\(M(\mathbf{T}_s)\)</span>, within-state segregation.</p>
<p>The between-within decomposition can also be applied repeatedly in a hierarchical setting. For instance, in the <code>schools00</code> dataset, schools are nested within districts, and districts are nested within states. Therefore, we can ask: How much segregation is due to segregation between states, how much segregation is due to between-district segregation within states, and how much segregation is due to between-school segregation within districts? The package provides a convenience function for this use case:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_total_nested</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;district&quot;</span>, <span class="st">&quot;school&quot;</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     between          within   stat        est</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;char&gt;          &lt;char&gt; &lt;char&gt;      &lt;num&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:    state                      M 0.09924370</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:    state                      H 0.09767398</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3: district           state      M 0.23870880</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4: district           state      H 0.23493319</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:   school state, district      M 0.08758648</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:   school state, district      H 0.08620114</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a simpler way of running the following three decompositions manually:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># mutual_total(schools00, &quot;race&quot;, &quot;state&quot;, weight = &quot;n&quot;)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mutual_total(schools00, &quot;race&quot;, &quot;district&quot;, within = &quot;state&quot;, weight = &quot;n&quot;)</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># mutual_total(schools00, &quot;race&quot;, &quot;school&quot;, within = c(&quot;state&quot;, &quot;district&quot;), weight = &quot;n&quot;)</span></span></code></pre></div>
</div>
<div id="local-segregation" class="section level2">
<h2>Local segregation</h2>
<p>The M index (but not the H index) allows for another decomposition, into local segregation scores. To define this decomposition, let <span class="math inline">\(p_{g|u} = t_{ug} / t_{u \cdot}\)</span> be the conditional probability of being in group <span class="math inline">\(g\)</span>, given that one is in unit <span class="math inline">\(u\)</span>. We can then define the <em>local segregation score of unit <span class="math inline">\(u\)</span></em> as</p>
<p><span class="math display">\[L_u = \sum_{g=1}^G p_{g|u}\log\frac{p_{g|u}}{p_{\cdot g}}\]</span> The weighted average of the <span class="math inline">\(L_u\)</span> is again <span class="math inline">\(M(\mathbf{T})\)</span>, i.e. <span class="math inline">\(M(\mathbf{T}) = \sum_{u=1}^U p_{u\cdot}L_u\)</span>.</p>
<p>To obtain the local segregation scores <span class="math inline">\(L_u\)</span>, along with the marginal weights <span class="math inline">\(p_{u\cdot}\)</span>, use <code>mutual_local()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_local</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>, <span class="at">wide =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Key: &lt;school&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       school        ls            p</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;fctr&gt;     &lt;num&gt;        &lt;num&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1:   A1_1 0.1826710 0.0004522985</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2:   A1_2 0.1825592 0.0004978701</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3:   A1_3 0.2756157 0.0006642066</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    4:   A1_4 0.1368034 0.0005685061</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    5:   A2_1 0.3585546 0.0004260948</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                              </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2041: C165_1 0.3174930 0.0004568556</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2042: C165_2 0.3835477 0.0005297702</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2043: C165_3 0.2972550 0.0005650883</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2044: C166_1 0.3072281 0.0011586588</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2045: C167_1 0.3166498 0.0005354667</span></span></code></pre></div>
<p>Local segregation scores are based on much less data than the full M index, so it often makes sense to obtain confidence intervals. The following code plots the length of the 95% confidence interval in relation to the size of each school:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>localse <span class="ot">&lt;-</span> <span class="fu">mutual_local</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">wide =</span> <span class="cn">TRUE</span>, <span class="at">n_bootstrap =</span> <span class="dv">500</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 bootstrap iterations on 877739 observations</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>localse<span class="sc">$</span>lengthCI <span class="ot">&lt;-</span> <span class="fu">sapply</span>(localse<span class="sc">$</span>ls_CI, base<span class="sc">::</span>diff)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(localse, <span class="fu">plot</span>(<span class="at">x =</span> p, <span class="at">y =</span> lengthCI, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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CJSGgAioNOhVsRAQAiIgPQNCQAiUhoAIqDToVbEQEAIiID0DQkAIlIaACKg06FWxEBACIiA9A0JACJSGgAioNOhVsRAQAiIgPQNCQAiUhoAIqDToVbEQEAIiID0DQkAIlIaACKg06FWxEBACIiA9A0JACJSGgAioNOhVsRAQAiIgPQNCQAiUhoAIqDToVbEQEAIiID0DQkAIlIaACKg06FWxEBACIiA9A0JACJSGgAioNOhVsRAQAiIgPQNCQAiUhoAIqDToVbEQEAIzCYLRIXD00Uen4447Ls0111yjO4GOEgJ9RmC22WZLF154YZpjjjn6XNPoTz9DZjL6w8fvke94xzvSIYccIgIav49A5a980qRJ6ZprrknLL798ZduqHtAob81MM82U5pxzzrTaaquN8gw6TAj0F4GlllqqvxX04OzSAfUAxNGe4t///ne69957R3u4jhMCtUdABFTiLWQYN3HixPTwww+X2ApVLQTKQ0BDsPKwT2ussUa666670utf//oSW6GqhUB5CIiAysM+nX766SXWrqqFQPkIaAhW/j1QC4TAuEVABDRub70uXAiUj4AIqPx7oBYIgXGLgAioZrf+yCOPTBtttFF68skna9ZyNVcIDEdABDQck0pv+clPfpIuuugit55VuqFqnBDoAgERUBNIP/zhD9Mss8xS+IeLO0Qw1nLeeeelK664Iq2wwgpjXbXqEwI9R0Bm+CZIt9tuu7TVVls1bR2+Os8886TFF198+I4+b/m///u/xJ9ECAwCAiKgprs4wwwzpJlnnrlp6/BVyvEnEQJCYPQIaAg2eux0pBAQAtOJgAhoOgHsx+G77757WmyxxdJ9993Xj9PrnEKgMgiIgCpzK15tCPFhDzzwgEztr0KiXwOKgHRAFbyxWLoee+yxtOCCC1awdWqSEOgdAuoB9Q7Lnp1p1llnFfn0DE2dqMoIiIDG6O789Kc/Td///vfHqDZVIwTqgcBAEdAzzzxTScUtabe32WabtOOOOyayIEqEgBD4LwIDpQM699xz01577ZUeeeSRSt1f/IVOPPHE9MQTT6R55523Um1TY4RAmQjUjoAIxrz77rtbYnb77bcnekGYsZGVVlopbb/99i3LjvVGPKxHI1deeWX60Ic+lCZPnuzXtcsuu/hpjj/++NGcTscIgUohUDsCuuGGG9IZZ5yRCIVYZJFF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va3NlS266KJD2rrAAgukO+64Y8g2rQwmAiKgwbyvtbqqp556akh70f8svvjiQ7ZpZTAREAEN5n2t1VVNnTq10d4sy9LVV1+dVlhhhcY2/RhcBGYa3EvTldUFgT333DO9+OKLad11102HHnpoevDBB9Ouu+5al+arndOBgAhoOsDTob1BYOONN07bbLONW7+WWWaZdPbZZ6eJEyf25uQ6S6URmMG6vFmlW6jGDSwCl112mVu8pk2blhZaaKH0yCOPpEUWWWRgr1cXNhwB6YCGY6ItJSAw66yzinxKwL3sKkVAZd8B1S8ExjECGoKN45tf9qU//fTTieHX0ksvnWaeeeaym6P6S0BABFQC6KpSCAiB/yKgIZieBCEgBEpDQARUGvSqWAgIARGQngEhIARKQ0AEVBr0qlgICAERkJ4BISAESkNABFQa9KpYCAgBEZCeASEgBEpDQARUGvSqWAgIARGQngEhIARKQ0AEVBr0qlgICAERkJ4BISAESkNABFQa9KpYCAgBEZCeASEgBEpDQARUGvSqWAgIARGQngEhIARKQ0AEVBr0qlgICAERkJ4BISAESkNABFQa9KpYCAgBEZCeASEgBEpD4P8BnveTzh3MiUwAAAAASUVORK5CYII=" /><!-- --></p>
<p>Although the relationship is not deterministic, larger schools have shorter confidence intervals.</p>
<p>Because the M is symmetric, local segregation scores can also be obtained for groups. The equivalent definition for the <em>local segregation score of group <span class="math inline">\(g\)</span></em> is then</p>
<p><span class="math display">\[L_g = \sum_{u=1}^U p_{u|g}\log\frac{p_{u|g}}{p_{u \cdot}},\]</span></p>
<p>and, as expected, <span class="math inline">\(M(\mathbf{T}) = \sum_{g=1}^G p_{\cdot g}L_g\)</span>.</p>
<p>To obtain these scores, switch the group and unit arguments in <code>mutual_local</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(localg <span class="ot">&lt;-</span> <span class="fu">mutual_local</span>(schools00, <span class="st">&quot;school&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>, <span class="at">wide =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Key: &lt;race&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      race        ls           p</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fctr&gt;     &lt;num&gt;       &lt;num&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  asian 0.6287673 0.022553401</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  black 0.8805413 0.190149919</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:   hisp 0.7766327 0.151696575</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:  white 0.1836393 0.628092178</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5: native 1.4342644 0.007507927</span></span></code></pre></div>
<p>These results show that the racial groups experience very different levels of segregation: White students are less segregated than Asian, Black, Hispanic, and, especially, Native American students.</p>
</div>
<div id="inference" class="section level2">
<h2>Inference</h2>
<p>The four main functions of the packages, <code>mutual_total()</code>, <code>mutual_within()</code>, <code>mutual_local()</code>, and <code>mutual_difference()</code> all support inference through bootstrapping. Inference for segregation indices is tricky, and the standard error estimates and confidence intervals should not be trusted too much when there is little data, and especially when the segregation index is very close to either 0 or maximum segregation.</p>
<p>To estimate standard errors and confidence intervals, use <code>se = TRUE</code>. The coverage of the confidence interval can be specified in the <code>CI</code> argument. The number of bootstrap iterations can be specified as well:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(se <span class="ot">&lt;-</span> <span class="fu">mutual_total</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">CI =</span> .<span class="dv">95</span>, <span class="at">n_bootstrap =</span> <span class="dv">500</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 bootstrap iterations on 877739 observations</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      stat       est           se                  CI        bias</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;char&gt;     &lt;num&gt;        &lt;num&gt;              &lt;list&gt;       &lt;num&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      M 0.4219229 0.0008062555 0.4202838,0.4234765 0.003616108</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      H 0.4152654 0.0007599100 0.4137861,0.4166715 0.003542878</span></span></code></pre></div>
<p>The confidence intervals are based on the percentiles from the bootstrap distribution, and hence require a large number of bootstrap iterations for valid interpretation. The estimate <code>est</code> that is reported in the results has already been “debiased”, i.e. the bias that has been estimated from the bootstrap distribution (which is reported in <code>bias</code>) has been subtracted from the usual maximum-likelihood estimate that we would obtain from <code>mutual_total</code> with <code>se = FALSE</code>. The confidence interval is centered around the debiased estimate.</p>
<p>On balance, confidence intervals are preferred over the standard error because the bootstrap distribution can be skewed, especially when segregation is very low or very high. For this example, we can see that the standard errors provide almost identical coverage to the confidence intervals, as</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(se, <span class="fu">c</span>(est[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se[<span class="dv">1</span>], est[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se[<span class="dv">1</span>]))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4203426 0.4235031</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># H</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(se, <span class="fu">c</span>(est[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se[<span class="dv">2</span>], est[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se[<span class="dv">2</span>]))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4137760 0.4167549</span></span></code></pre></div>
<p>provide effectively the same coverage as the confidence intervals obtained from the percentile bootstrap.</p>
<p>Whenever the bootstrap is used, the bootstrap distributions for each parameter are reported in an attribute <code>bootstrap</code> of the returned object. This can be used, for instance, to check whether the bootstrap distribution is skewed. The following code computes local segregation scores for all schools, and then shows a histogram of the bootstrap distribution for school C137_9, which has a very low local segregation score:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>local <span class="ot">&lt;-</span> <span class="fu">mutual_local</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">CI =</span> .<span class="dv">95</span>, <span class="at">n_bootstrap =</span> <span class="dv">500</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 bootstrap iterations on 877739 observations</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pick bootstrap distribution of local segregation scores for school C137_9</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>ls_school <span class="ot">&lt;-</span> <span class="fu">attr</span>(local, <span class="st">&quot;bootstrap&quot;</span>)[school <span class="sc">==</span> <span class="st">&quot;C137_9&quot;</span> <span class="sc">&amp;</span> stat <span class="sc">==</span> <span class="st">&quot;ls&quot;</span>, boot_est]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ls_school, <span class="at">main =</span> <span class="st">&quot;Bootstrap distribution for school C137_9&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For this school, the bootstrap distribution is skewed. If precise inference about this specific school is needed, the standard error should not be interpreted, and the confidence interval should only be interpreted when the number of bootstrap iterations is large.</p>
<p>If you are concerned that your contingency table is too small to provide reliable segregation estimates, the package also provides a function <code>mutual_expected()</code> that simulates random cell counts under independence from the marginal distributions of your table. For the <code>schools00</code> dataset:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_expected</span>(schools00, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>, <span class="at">n_bootstrap =</span> <span class="dv">500</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stat         est           se</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;char&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: M under 0 0.004802852 7.120166e-05</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: H under 0 0.004726886 7.007548e-05</span></span></code></pre></div>
<p>Here, there is no concern about bias due to a small sample size.</p>
</div>
<div id="decomposing-differences-in-indices" class="section level2">
<h2>Decomposing differences in indices</h2>
<p>The command <code>mutual_difference()</code> can be used to decompose differences in segregation, as described in Elbers (2021). The default, and recommended method, is to use <code>method = shapley</code> (or <code>method = shapley_detailed</code>). The other methods (<code>mrc</code>, <code>km</code>) exist mostly for testing purposes, and are not recommended. Details on the procedure and how to interpret the terms of the decomposition are found in Elbers (2021).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutual_difference</span>(schools00, schools05, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="at">weight =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              stat          est</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &lt;char&gt;        &lt;num&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:             M1  0.425538976</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:             M2  0.413385092</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:           diff -0.012153884</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:      additions -0.003412776</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:       removals -0.011405093</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6: group_marginal  0.017871051</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7:  unit_marginal -0.011712727</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8:     structural -0.003494338</span></span></code></pre></div>
<p>This method also supports inference by setting <code>se = TRUE</code>.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Elbers, B. (2021). A Method for Studying Differences in Segregation Across Time and Space. Sociological Methods &amp; Research. <a href="https://doi.org/10.1177/0049124121986204" class="uri">https://doi.org/10.1177/0049124121986204</a></p>
<p>Mora, R., &amp; Ruiz-Castillo, J. (2011). Entropy-based Segregation Indices. Sociological Methodology, 41(1), 159–194. <a href="https://doi.org/10.1111/j.1467-9531.2011.01237.x" class="uri">https://doi.org/10.1111/j.1467-9531.2011.01237.x</a></p>
<p>Theil, H. (1971). Principles of Econometrics. New York: Wiley</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
